# ディレクトリ構造
Teamsのディレクトリ構造は以下の通りです。

```
衛星データ/
├── データについて.md
├── Python/ # Pythonスクリプトを格納する
│   ├── gee_landsat8_get_data.py # GEEからLandsat8のデータ（LSTと反射バンド）を観測日ごとに取得するスクリプト
│ 
├── Landsat8/ # Landsat8のデータを格納する
│   ├── LST/ # 地表面温度データを格納する
│   │   ├── Landsat8_LST 2024/
│   │   │   ├── L8_20240420_032252_Hanoi_LST.tif  # 2024年4月20日 03:22:52のLSTデータ
│   │   │   ├── ・・・
│   │   │
│   │   ├── Landsat8_LST 2023/
│   │   │   ├──  ・・・
│   │   
│   ├── 反射バンド/ # 反射バンドデータを格納する　（SR_B1~B7）
│   │   ├── Landsat8_反射バンド 2024/
│   │   │   ├── L8_20240420_032252_Hanoi_Reflectance.tif  # 2024年4月20日 03:22:52の反射バンドデータ
│   │   │   ├── ・・・
│   │   │
│   │   ├── Landsat8_反射バンド 2023/
│   │   │   ├──  ・・・
│   │
│   ├── メタデータ/ # メタデータを格納する
│       ├── image_metadata_2024.csv # 2024年のLandsat8データのメタデータ
│       ├── image_metadata_2023.csv # 
│       ├── ・・・
│
└── 月平均Landsat8データ/ # 月平均Landsat8データを格納する
    ├── 月平均LST/ # 月平均地表面温度データを格納する
        ├── LST_Mean_2024/
        │   ├── LST_Mean_202404_Hanoi.tif  # 2024年4月の月平均LSTデータ
        │   ├── ・・・
        │
        ├── LST_Mean_2023/
           ├── ・・・
    
    
```

# 各ファイルの説明

### メタデータ（image_metadata_2024.csv、image_metadata_2023.csvなど）：

- 記載項目：日時,全体ピクセル数,有効ピクセル率,出力有無,観測時刻
- 日時：　Landsat8のデータ取得日を示す。例えば、2024-04-20は2024年4月20日に取得したデータであることを示す。
- 全体ピクセル数：Hanoiの行政区画全体のピクセル数は　約3,500,000ピクセルであり、全体ピクセル数はデータの含まれるピクセル数を示す。
- 有効ピクセル率：　有効ピクセル率は、雲や影などで覆われていない有効なピクセル数を、データの含まれるピクセル数で割った値である。（行政区画全体のピクセル数に対する割合ではないことに注意）
- 出力有無：　geotiffファイルを出力したかどうかを示す。出力条件は 全体ピクセル数 & 有効ピクセル率　の両方を満たす場合（閾値はスクリプト内で設定可能）
- 観測時刻：　観測時刻はLandsat8のデータ取得時間（UTC）を示す。例えば、03:22:52は日本時間で12:22:52に相当する。


### gee_landsat8_get_data.py

- 概要：Google Earth Engine (GEE) を用いて、Landsat8の地表面温度（LST）と反射バンド（SR_B1~B7）のデータを取得し、指定した条件に基づいてgeotiff形式でエクスポートするPythonスクリプト。

- 主な機能：
    - 指定した行政区画（ROI）のシェープファイルをもとに、対象領域の画像を抽出
    - 雲・影・シーラスのマスク処理により有効ピクセルのみを抽出
    - 各バンドにスケールファクターを適用し、物理量（反射率・温度）に変換
    - 有効ピクセル率（雲の影響を受けていない割合）と全体ピクセル数を計算
    - 有効ピクセル率・全体ピクセル数が閾値以上の場合のみ、LST・反射バンド画像をGoogle DriveへGeoTIFF形式でエクスポート
    - 画像ごとにメタデータ（日時、ピクセル数、有効率、出力有無、観測時刻）を記録し、CSVとして保存

- 主な処理フロー：
    1. Earth Engineの初期化と認証
    2. 対象行政区画（ROI）の取得
    3. Landsat8画像コレクションのフィルタ・前処理（雲マスク・スケール変換）
    4. 各画像について有効ピクセル率・全体ピクセル数を判定し、条件を満たす場合のみエクスポート
    5. 画像ごとのメタデータをCSVにまとめて保存

- 出力内容：
    - GeoTIFF形式のLST画像（地表面温度）
    - GeoTIFF形式の反射バンド画像（SR_B1~B7）
    - 画像ごとのメタデータCSV（image_metadata_YYYY.csv）

- 備考：
    - エクスポート条件（有効ピクセル率・全体ピクセル数）はスクリプト内で設定可能
    - 画像の観測日時・時刻はメタデータCSVに記録される